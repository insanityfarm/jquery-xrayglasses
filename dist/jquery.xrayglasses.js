!function(s,a){var e=function(s,e){xrayglasses=this,xrayglasses.elem=s,xrayglasses.$elem=a(s),xrayglasses.options=e};e.prototype={defaults:{overlayOpacity:.8,toggleKeyCode:88,lens:"round",scale:1},init:function(){return xrayglasses.config=a.extend({},xrayglasses.defaults,xrayglasses.options),xrayglasses.data={page:a(document),viewport:a(s),body:a("body"),pageWrapper:xrayglasses.$elem,lensImage:"",lensWidth:0,lensHeight:0},xrayglasses.attach(),xrayglasses.data.viewport.on("scroll",xrayglasses.updateFixedPositions).on("resize",xrayglasses.update).on("mousemove",xrayglasses.move).on("keyup keydown",xrayglasses.keypress),xrayglasses},attach:function(){var s=function(){xrayglasses.data.lensWidth=this.width*xrayglasses.config.scale,xrayglasses.data.lensHeight=this.height*xrayglasses.config.scale;var s=a('<svg id="xrayglasses" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><mask id="mask" maskUnits="userSpaceOnUse" maskContentUnits="userSpaceOnUse"><image width="'+xrayglasses.data.lensWidth+'px" height="'+xrayglasses.data.lensHeight+'px" xlink:href="'+xrayglasses.data.lensImage+'"></image></mask></defs><rect id="xrayglassesOverlay" width="100%" height="100%" /><foreignObject width="100%" height="100%" style="mask: url(#mask);"><div class="wrapper"></div></foreignObject></svg>');xrayglasses.data.pageWrapper.after(s),xrayglasses.data.xrayglasses=a("#xrayglasses"),xrayglasses.data.overlay=a("#xrayglassesOverlay"),xrayglasses.data.embeddedMaskLens=a("#mask image"),xrayglasses.data.xrayglassesContent=a("#xrayglasses .wrapper"),xrayglasses.data.xrayglassesContent.css({"-webkit-mask-image":"url('"+xrayglasses.data.lensImage+"')","-webkit-mask-size":xrayglasses.data.lensWidth+"px "+xrayglasses.data.lensHeight+"px"}),xrayglasses.data.overlay.css({fill:"rgba(0,0,0,"+xrayglasses.config.overlayOpacity+")"}),xrayglasses.update()};a("<img/>",{src:xrayglasses.data.lensImage=xrayglasses.getLensImage(),load:s})},update:function(){xrayglasses.data.xrayglassesContent.html(xrayglasses.data.pageWrapper.html()),xrayglasses.data.pageWidth=xrayglasses.data.viewport.width(),xrayglasses.data.pageHeight=xrayglasses.data.page.height()>xrayglasses.data.viewport.height()?xrayglasses.data.page.height():xrayglasses.data.viewport.height(),xrayglasses.data.xrayglasses.attr({width:xrayglasses.data.pageWidth,height:xrayglasses.data.pageHeight}),xrayglasses.data.overlay.attr({width:xrayglasses.data.pageWidth,height:xrayglasses.data.pageHeight}),xrayglasses.data.xrayglassesContent.css({height:xrayglasses.data.pageHeight,paddingLeft:xrayglasses.data.body.css("marginLeft"),paddingRight:xrayglasses.data.body.css("marginRight")}),xrayglasses.updateFixedPositions()},move:function(s){xrayglasses.data.xrayglassesContent.css({"-webkit-mask-position-x":s.pageX-xrayglasses.data.lensWidth/2,"-webkit-mask-position-y":s.pageY-xrayglasses.data.lensHeight/2}),xrayglasses.data.embeddedMaskLens.attr({x:s.pageX-xrayglasses.data.lensWidth/2,y:s.pageY-xrayglasses.data.lensHeight/2})},updateFixedPositions:function(){var s=xrayglasses.data.viewport.scrollTop(),e=xrayglasses.data.viewport.scrollLeft();xrayglasses.data.xrayglasses.find(".fixed").each(function(){a(this).css({marginTop:"auto"==a(this).css("top")?"auto":s,marginLeft:"auto"==a(this).css("left")?"auto":e})})},keypress:function(s){if((s.keyCode||s.which)==xrayglasses.config.toggleKeyCode){var a="keydown"===s.type,e=xrayglasses.data.xrayglasses.css("opacity")<.5;a===e&&xrayglasses.data.xrayglasses.fadeTo(100,e?1:0)}},getLensImage:function(){var s={round:"round.png"};return s.hasOwnProperty(xrayglasses.config.lens)?s[xrayglasses.config.lens]:xrayglasses.config.lens}},e.defaults=e.prototype.defaults,a.fn.xrayglasses=function(s){return this.each(function(){new e(this,s).init()})},s.XRayGlasses=e}(window,jQuery);